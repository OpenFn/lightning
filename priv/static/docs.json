[
  {
    "functions": [
      {
        "arity": 2,
        "name": "create",
        "metadata": {
          "source_annos": [
            [
              132,
              7
            ]
          ]
        },
        "doc": "Creates a new credential and optionally grants it access to projects.\n\nCreates a credential owned by the authenticated user. If project_credentials\nare specified, the user must have access to all listed projects. The credential\nbody is included in the response only upon creation.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `name` - Credential name (required)\n  - `body` - Credential JSON body with authentication details (required)\n  - `project_credentials` - List of project associations (optional)\n\n## Returns\n\n- `201 Created` with credential JSON including body\n- `422 Unprocessable Entity` on validation errors\n- `403 Forbidden` if user lacks access to specified projects\n\n## Examples\n\n    # Create credential without project association\n    POST /api/credentials\n    {\n      \"name\": \"My API Key\",\n      \"body\": {\"apiKey\": \"secret123\"}\n    }\n\n    # Create credential with project associations\n    POST /api/credentials\n    {\n      \"name\": \"Shared Credential\",\n      \"body\": {\"token\": \"abc123\"},\n      \"project_credentials\": [\n        {\"project_id\": \"a1b2c3d4-...\"}\n      ]\n    }\n"
      },
      {
        "arity": 2,
        "name": "delete",
        "metadata": {
          "source_annos": [
            [
              167,
              7
            ]
          ]
        },
        "doc": "Deletes a credential owned by the authenticated user.\n\nPermanently removes a credential. Only the credential owner can delete it.\nCredentials in use by workflows cannot be deleted and will return an error.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `id` - Credential UUID (required)\n\n## Returns\n\n- `204 No Content` on successful deletion\n- `404 Not Found` if credential doesn't exist or invalid UUID\n- `403 Forbidden` if user is not the credential owner\n\n## Examples\n\n    DELETE /api/credentials/a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d\n"
      },
      {
        "arity": 2,
        "name": "index",
        "metadata": {
          "source_annos": [
            [
              62,
              7
            ]
          ]
        },
        "doc": "Lists credentials with optional project filtering.\n\nThis function has two variants:\n- With `project_id`: Returns all credentials for a specific project (regardless of owner)\n- Without `project_id`: Returns only credentials owned by the authenticated user\n\nCredential bodies are excluded from responses for security.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `project_id` - Project UUID (optional, filters to specific project)\n\n## Returns\n\n- `200 OK` with list of credentials (bodies excluded)\n- `404 Not Found` if project doesn't exist (when project_id provided)\n- `403 Forbidden` if user lacks project access (when project_id provided)\n\n## Examples\n\n    # User's own credentials\n    GET /api/credentials\n\n    # All credentials for a project\n    GET /api/credentials?project_id=a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d\n"
      }
    ],
    "module": "LightningWeb.API.CredentialController",
    "moduledoc": "API controller for credential management.\n\nHandles creation, retrieval, and deletion of credentials. Credentials are\nused to authenticate with external services and can be associated with\nmultiple projects.\n\n## Security\n\n- Credential bodies are excluded from responses for security\n- Users can only delete credentials they own\n- Project access is required to view project credentials\n\n## Examples\n\n    GET /api/credentials\n    GET /api/credentials?project_id=a1b2c3d4-...\n    POST /api/credentials\n    DELETE /api/credentials/a1b2c3d4-...\n"
  },
  {
    "functions": [
      {
        "arity": 2,
        "name": "index",
        "metadata": {
          "source_annos": [
            [
              65,
              7
            ]
          ]
        },
        "doc": "Lists jobs with optional project filtering.\n\nThis function has two variants:\n- With `project_id`: Returns jobs for a specific project\n- Without `project_id`: Returns jobs across all accessible projects\n\nReturns a paginated list of jobs.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `project_id` - Project UUID (optional, filters to specific project)\n  - `page` - Page number (optional, default: 1)\n  - `page_size` - Items per page (optional, default: 10)\n\n## Returns\n\n- Renders JSON with paginated list of jobs\n- `404 Not Found` if project doesn't exist (when project_id provided)\n- `403 Forbidden` if user lacks project access (when project_id provided)\n\n## Examples\n\n    # All jobs accessible to user\n    GET /api/jobs\n    GET /api/jobs?page=3&page_size=25\n\n    # Jobs for specific project\n    GET /api/jobs?project_id=a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d\n    GET /api/jobs?project_id=a1b2c3d4-...&page=2&page_size=50\n"
      },
      {
        "arity": 2,
        "name": "show",
        "metadata": {
          "source_annos": [
            [
              118,
              7
            ]
          ]
        },
        "doc": "Retrieves a specific job by ID.\n\nReturns detailed information about a single job including its body, adaptor,\nand workflow association. Access is granted if the user has access to the\njob's parent project.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `id` - Job UUID (required)\n\n## Returns\n\n- `200 OK` with job JSON on success\n- `404 Not Found` if job doesn't exist\n- `403 Forbidden` if user lacks project access\n\n## Examples\n\n    GET /api/jobs/a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d\n"
      }
    ],
    "module": "LightningWeb.API.JobController",
    "moduledoc": "API controller for job management.\n\nProvides read access to jobs within workflows. Jobs are JavaScript execution\nunits that process data using OpenFn adaptors. Jobs belong to workflows and\ninherit access controls from their parent project.\n\n## Query Parameters (index)\n\n- `page` - Page number (default: 1)\n- `page_size` - Number of items per page (default: 10)\n- `project_id` - Filter jobs by project UUID (optional)\n\n## Examples\n\n    GET /api/jobs\n    GET /api/jobs?project_id=a1b2c3d4-...&page=1&page_size=20\n    GET /api/jobs/a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d\n"
  },
  {
    "functions": [
      {
        "arity": 2,
        "name": "create",
        "metadata": {
          "source_annos": [
            [
              159,
              7
            ]
          ]
        },
        "doc": "Creates a new workflow in a project.\n\nCreates a workflow with jobs, triggers, and edges. Validates the workflow\nstructure and ensures it forms a valid DAG with no cycles.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `project_id` - Project UUID (required)\n  - `name` - Workflow name (required)\n  - `jobs` - List of job definitions with UUIDs (required)\n  - `triggers` - List of trigger definitions with UUIDs (required)\n  - `edges` - List of edge definitions connecting jobs/triggers (required)\n\n## Returns\n\n- `201 Created` with workflow JSON on success\n- `422 Unprocessable Entity` with validation errors\n- `403 Forbidden` if user lacks write access\n\n## Examples\n\n    POST /api/workflows\n    {\n      \"project_id\": \"a1b2c3d4-...\",\n      \"name\": \"Data Processing Pipeline\",\n      \"jobs\": [\n        {\n          \"id\": \"job-uuid-1\",\n          \"name\": \"Extract Data\",\n          \"body\": \"fn(state => state)\"\n        }\n      ],\n      \"triggers\": [\n        {\n          \"id\": \"trigger-uuid-1\",\n          \"type\": \"webhook\",\n          \"enabled\": true\n        }\n      ],\n      \"edges\": [\n        {\n          \"source_trigger_id\": \"trigger-uuid-1\",\n          \"target_job_id\": \"job-uuid-1\",\n          \"condition\": \"always\"\n        }\n      ]\n    }\n"
      },
      {
        "arity": 2,
        "name": "index",
        "metadata": {
          "source_annos": [
            [
              85,
              7
            ]
          ]
        },
        "doc": "Lists workflows with optional project filtering.\n\nThis function has two variants:\n- With `project_id`: Returns workflows for a specific project\n- Without `project_id`: Returns workflows across all accessible projects\n\nReturns all workflows including their jobs, triggers, and edges.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `project_id` - Project UUID (optional, filters to specific project)\n\n## Returns\n\n- `200 OK` with workflows list and empty errors map\n- `404 Not Found` if project doesn't exist (when project_id provided)\n- `403 Forbidden` if user lacks project access (when project_id provided)\n\n## Examples\n\n    # All workflows accessible to user\n    GET /api/workflows\n\n    # Workflows for specific project\n    GET /api/workflows?project_id=a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d\n"
      },
      {
        "arity": 2,
        "name": "show",
        "metadata": {
          "source_annos": [
            [
              202,
              7
            ]
          ]
        },
        "doc": "Retrieves a workflow by ID.\n\nThis function has two variants:\n- With `project_id`: Validates workflow belongs to specified project\n- Without `project_id`: Determines project access from workflow association\n\nReturns a workflow with all its jobs, triggers, and edges.\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `id` - Workflow UUID (required)\n  - `project_id` - Project UUID (optional, for validation)\n\n## Returns\n\n- `200 OK` with workflow JSON on success\n- `404 Not Found` if workflow doesn't exist\n- `400 Bad Request` if workflow exists but project_id mismatch\n- `403 Forbidden` if user lacks project access\n\n## Examples\n\n    # Get workflow by ID only\n    GET /api/workflows/a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d\n\n    # Get workflow with project validation\n    GET /api/workflows/workflow-uuid-1?project_id=a1b2c3d4-...\n"
      },
      {
        "arity": 2,
        "name": "update",
        "metadata": {
          "source_annos": [
            [
              262,
              7
            ]
          ]
        },
        "doc": "Updates an existing workflow.\n\nModifies a workflow's structure, including its jobs, triggers, and edges.\nValidates the updated workflow forms a valid DAG. Prevents updates while\nworkflow is being edited in the UI (active presence).\n\n## Parameters\n\n- `conn` - The Plug connection struct with the current resource assigned\n- `params` - Map containing:\n  - `project_id` - Project UUID (required, must match workflow's project)\n  - `id` - Workflow UUID (required)\n  - `name` - Updated workflow name (optional)\n  - `jobs` - Updated jobs list (optional)\n  - `triggers` - Updated triggers list (optional, cannot replace existing)\n  - `edges` - Updated edges list (optional)\n\n## Returns\n\n- `200 OK` with updated workflow JSON on success\n- `422 Unprocessable Entity` with validation errors\n- `409 Conflict` if workflow has active presence\n- `403 Forbidden` if user lacks write access\n- `404 Not Found` if workflow doesn't exist\n\n## Examples\n\n    PATCH /api/workflows/workflow-uuid-1?project_id=a1b2c3d4-...\n    {\n      \"name\": \"Updated Pipeline Name\",\n      \"jobs\": [...]\n    }\n"
      }
    ],
    "module": "LightningWeb.API.WorkflowsController",
    "moduledoc": "API controller for workflow management.\n\nHandles CRUD operations for workflows, including their jobs, triggers, and edges.\nWorkflows are directed acyclic graphs (DAGs) that define data processing pipelines.\n\n## Workflow Structure\n\nA workflow consists of:\n- Jobs: JavaScript execution units with adaptors\n- Triggers: Initiation methods (Webhook, Cron, Kafka)\n- Edges: Connections between triggers/jobs with conditions\n\n## Validation Rules\n\n- Workflows must be valid DAGs (no cycles)\n- Only one trigger can be enabled at a time\n- All jobs and triggers must have valid UUIDs\n- Edges must reference existing jobs/triggers\n- Cannot modify workflows with active presence (being edited in UI)\n\n## Examples\n\n    GET /api/workflows\n    GET /api/workflows?project_id=a1b2c3d4-...\n    GET /api/workflows/a1b2c3d4-...\n    POST /api/workflows\n    PATCH /api/workflows/a1b2c3d4-...\n"
  }
]